#!/usr/bin/env python

# Bit-Shift-Encoder
# Paw Petersen, SLAE-656
# https://www.pawpetersen.dk/slae-assignment-4-bit-shift-encoder-linux-x86/

sc = ("\x68\x0a\x0a\x0a\x0a\x68\x72\x6b\x73\x21\x68\x72\x20\x77\x6f"
  "\x68\x63\x6f\x64\x65\x68\x74\x20\x45\x6e\x68\x53\x68\x69\x66\x68"
  "\x42\x69\x74\x2d\x31\xc9\xb1\x19\x51\xb8\x11\x11\x51\x08\x50\x31"
  "\xc0\x50\x54\x51\x89\xe6\x83\xc6\x14\x03\x74\x24\x10\x2b\x34\x24"
  "\x56\x89\xf1\xeb\x1c\xeb\x0c\x59\x59\xe2\xe8\x31\xdb\x31\xc0\xb0"
  "\x01\xcd\x80\x31\xc0\xb0\xa2\x8d\x5c\x24\x0c\x31\xc9\xcd\x80\xeb"
  "\xe6\x31\xd2\xb2\x01\x31\xdb\xb3\x01\x31\xc0\xb0\x04\xcd\x80\xeb"
  "\xd4")

print "In:"
print ",".join("0x%02x" % ord(c) for c in sc)

encoded = ""
for i in range(len(sc)):
	low = (ord(sc[i])&0x0f)<<4
	high = (ord(sc[i])&0xf0)>>4
	encoded += chr(low|high)

encoded += "\xaa"

print "\nOut:"
print ",".join("0x%02x" % ord(c) for c in encoded)
