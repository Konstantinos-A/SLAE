// Bit-Shift-Decoder Test
// Paw Petersen, SLAE-656
// https://www.pawpetersen.dk/slae-assignment-4-bit-shift-encoder-linux-x86/

#include<stdio.h>
#include<string.h>

unsigned char code[] = \
  "\xeb\x1c\x5e\x8a\x06\x88\xc3\x24\x0f\x80\xe3\xf0\xc0\xe0\x04\xc0\xeb\x04"
  "\x08\xd8\x88\x06\x46\x80\x3e\xaa\x75\xe7\xeb\x05\xe8\xdf\xff\xff\xff\x86"
  "\xa0\xa0\xa0\xa0\x86\x27\xb6\x37\x12\x86\x27\x02\x77\xf6\x86\x36\xf6\x46"
  "\x56\x86\x47\x02\x54\xe6\x86\x35\x86\x96\x66\x86\x24\x96\x47\xd2\x13\x9c"
  "\x1b\x91\x15\x8b\x11\x11\x15\x80\x05\x13\x0c\x05\x45\x15\x98\x6e\x38\x6c"
  "\x41\x30\x47\x42\x01\xb2\x43\x42\x65\x98\x1f\xbe\xc1\xbe\xc0\x95\x95\x2e"
  "\x8e\x13\xbd\x13\x0c\x0b\x10\xdc\x08\x13\x0c\x0b\x2a\xd8\xc5\x42\xc0\x13"
  "\x9c\xdc\x08\xbe\x6e\x13\x2d\x2b\x10\x13\xbd\x3b\x10\x13\x0c\x0b\x40\xdc"
  "\x08\xbe\x4d\xaa";

main()
{
  printf("Shellcode Length:  %d\n", strlen(code));
	int (*ret)() = (int(*)())code;
	ret();
}
